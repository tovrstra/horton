

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.9.11. horton.meanfield.project – Projection of 1-electron orbitals to a new basis set &mdash; HORTON 2.0.0-244-gaaf5e2b documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
    <link rel="top" title="HORTON 2.0.0-244-gaaf5e2b documentation" href="../index.html"/>
        <link rel="up" title="3.9. horton.meanfield – Mean-field electronic structure code" href="pck_horton_meanfield.html"/>
        <link rel="next" title="3.9.12. horton.meanfield.response – Evaluation of response functions" href="mod_horton_meanfield_response.html"/>
        <link rel="prev" title="3.9.10. horton.meanfield.occ – Occupation number models" href="mod_horton_meanfield_occ.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/horton.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro_horton_overview.html">1. HORTON Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_citing_horton.html">2. Citing HORTON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_license_information.html">3. License Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_contact_information.html">4. Contact Information</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_download_and_install.html">1. Download and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_getting_started.html">2. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_hamiltonian.html">3. Hamiltonians</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_estruct.html">4. Electronic Structure Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_postproc.html">5. Post-processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_other.html">6. Other Topics</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical stuff</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tech_dev.html">1. Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tech_ref.html">2. Reference Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tech_api.html">3. API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pck_horton.html">3.1. <code class="docutils literal"><span class="pre">horton</span></code> &#8211; The main HORTON Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_correlatedwfn.html">3.2. <code class="docutils literal"><span class="pre">horton.correlatedwfn</span></code> &#8211; Methods for correlated wavefunctions</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_espfit.html">3.3. <code class="docutils literal"><span class="pre">horton.espfit</span></code> &#8211; Electrostatic potential fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_gbasis.html">3.4. <code class="docutils literal"><span class="pre">horton.gbasis</span></code> &#8211; Gaussian basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_grid.html">3.5. <code class="docutils literal"><span class="pre">horton.grid</span></code> &#8211; Numerical integration grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_io.html">3.6. <code class="docutils literal"><span class="pre">horton.io</span></code> &#8211; Input and output routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_localization.html">3.7. <code class="docutils literal"><span class="pre">horton.localization</span></code> &#8211; Methods for orbital localization</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_matrix.html">3.8. <code class="docutils literal"><span class="pre">horton.matrix</span></code> &#8211; One-, two-, three- and four-dimensional matrix implementations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="pck_horton_meanfield.html">3.9. <code class="docutils literal"><span class="pre">horton.meanfield</span></code> &#8211; Mean-field electronic structure code</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_bond_order.html">3.9.1. <code class="docutils literal"><span class="pre">horton.meanfield.bond_order</span></code> &#8211; Generic implementation of bond orders for mean-field wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_builtin.html">3.9.2. <code class="docutils literal"><span class="pre">horton.meanfield.builtin</span></code> &#8211; Built-in energy terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_cext.html">3.9.3. <code class="docutils literal"><span class="pre">horton.meanfield.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_convergence.html">3.9.4. <code class="docutils literal"><span class="pre">horton.meanfield.convergence</span></code> &#8211; Evaluation of convergence criteria</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_gridgroup.html">3.9.5. <code class="docutils literal"><span class="pre">horton.meanfield.gridgroup</span></code> &#8211; Container for observables involving numerical integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_guess.html">3.9.6. <code class="docutils literal"><span class="pre">horton.meanfield.guess</span></code> &#8211; Initial guesses for wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_hamiltonian.html">3.9.7. <code class="docutils literal"><span class="pre">horton.meanfield.hamiltonian</span></code> &#8211; Mean-field DFT/HF Hamiltonian data structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_libxc.html">3.9.8. <code class="docutils literal"><span class="pre">horton.meanfield.libxc</span></code> &#8211; Interface to LDA, GGA and hybrid functionals from LibXC</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_observable.html">3.9.9. <code class="docutils literal"><span class="pre">horton.meanfield.observable</span></code> &#8211; Base classes for energy terms and other observables of the wavefunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_occ.html">3.9.10. <code class="docutils literal"><span class="pre">horton.meanfield.occ</span></code> &#8211; Occupation number models</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.9.11. <code class="docutils literal"><span class="pre">horton.meanfield.project</span></code> &#8211; Projection of 1-electron orbitals to a new basis set</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_response.html">3.9.12. <code class="docutils literal"><span class="pre">horton.meanfield.response</span></code> &#8211; Evaluation of response functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_rotate.html">3.9.13. <code class="docutils literal"><span class="pre">horton.meanfield.rotate</span></code> &#8211; Rotation of orbitals</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf.html">3.9.14. <code class="docutils literal"><span class="pre">horton.meanfield.scf</span></code> &#8211; Basic Self-Consistent Field (SCF) algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf_cdiis.html">3.9.15. <code class="docutils literal"><span class="pre">horton.meanfield.scf_cdiis</span></code> &#8211; Commutator DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf_diis.html">3.9.16. <code class="docutils literal"><span class="pre">horton.meanfield.scf_diis</span></code> &#8211; Abstract DIIS code used by the different DIIS implementations</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf_ediis.html">3.9.17. <code class="docutils literal"><span class="pre">horton.meanfield.scf_ediis</span></code> &#8211; Energy DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf_ediis2.html">3.9.18. <code class="docutils literal"><span class="pre">horton.meanfield.scf_ediis2</span></code> &#8211; EDIIS+DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf_oda.html">3.9.19. <code class="docutils literal"><span class="pre">horton.meanfield.scf_oda</span></code> &#8211; Optimal Damping SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_utils.html">3.9.20. <code class="docutils literal"><span class="pre">horton.meanfield.utils</span></code> &#8211; Utility functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_modelhamiltonians.html">3.10. <code class="docutils literal"><span class="pre">horton.modelhamiltonians</span></code> &#8211; Model Hamiltonians</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_orbital_entanglement.html">3.11. <code class="docutils literal"><span class="pre">horton.orbital_entanglement</span></code> &#8211; Methods for measuring orbital entanglement</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_part.html">3.12. <code class="docutils literal"><span class="pre">horton.part</span></code> &#8211; Density-based partitioning (fuzzy atoms-in-molecules) package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_scripts.html">3.13. <code class="docutils literal"><span class="pre">horton.scripts</span></code> &#8211; Code (solely) used by HORTON&#8217;s command line scripts</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">HORTON</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../tech_api.html">3. API Documentation</a> &raquo;</li>
      
          <li><a href="pck_horton_meanfield.html">3.9. <code class="docutils literal"><span class="pre">horton.meanfield</span></code> &#8211; Mean-field electronic structure code</a> &raquo;</li>
      
    <li>3.9.11. <code class="docutils literal"><span class="pre">horton.meanfield.project</span></code> &#8211; Projection of 1-electron orbitals to a new basis set</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/lib/mod_horton_meanfield_project.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-horton.meanfield.project">
<span id="horton-meanfield-project-projection-of-1-electron-orbitals-to-a-new-basis-set"></span><h1>3.9.11. <code class="docutils literal"><span class="pre">horton.meanfield.project</span></code> &#8211; Projection of 1-electron orbitals to a new basis set<a class="headerlink" href="#module-horton.meanfield.project" title="Permalink to this headline">¶</a></h1>
<dl class="exception">
<dt id="horton.meanfield.project.ProjectionError">
<em class="property">exception </em><code class="descclassname">horton.meanfield.project.</code><code class="descname">ProjectionError</code><a class="headerlink" href="#horton.meanfield.project.ProjectionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<dl class="attribute">
<dt id="horton.meanfield.project.ProjectionError.args">
<code class="descname">args</code><a class="headerlink" href="#horton.meanfield.project.ProjectionError.args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="horton.meanfield.project.ProjectionError.message">
<code class="descname">message</code><a class="headerlink" href="#horton.meanfield.project.ProjectionError.message" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="horton.meanfield.project.project_orbitals_mgs">
<code class="descclassname">horton.meanfield.project.</code><code class="descname">project_orbitals_mgs</code><span class="sig-paren">(</span><em>obasis0</em>, <em>obasis1</em>, <em>exp0</em>, <em>exp1</em>, <em>eps=1e-10</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.project.project_orbitals_mgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Project the orbitals onto a new basis set with the modified Gram-Schmidt algorithm.</p>
<p>The orbitals in <code class="docutils literal"><span class="pre">exp0</span></code> (w.r.t. <code class="docutils literal"><span class="pre">obasis0</span></code>) are projected onto <code class="docutils literal"><span class="pre">obasis1</span></code> and
stored in <code class="docutils literal"><span class="pre">exp1</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obasis0</strong> (<a class="reference internal" href="mod_horton_gbasis_cext.html#horton.gbasis.cext.GOBasis" title="horton.gbasis.cext.GOBasis"><em>GOBasis</em></a>) &#8211; The orbital basis for the original wavefunction expansion.</li>
<li><strong>obasis1</strong> (<a class="reference internal" href="mod_horton_gbasis_cext.html#horton.gbasis.cext.GOBasis" title="horton.gbasis.cext.GOBasis"><em>GOBasis</em></a>) &#8211; The new orbital basis for the projected wavefunction expansion.</li>
<li><strong>exp0</strong> (<a class="reference internal" href="mod_horton_matrix_dense.html#horton.matrix.dense.DenseExpansion" title="horton.matrix.dense.DenseExpansion"><em>DenseExpansion</em></a>) &#8211; The expansion of the original orbitals.</li>
<li><strong>exp1</strong> (<a class="reference internal" href="mod_horton_matrix_dense.html#horton.matrix.dense.DenseExpansion" title="horton.matrix.dense.DenseExpansion"><em>DenseExpansion</em></a>) &#8211; An output argument in which the projected orbitals will be stored.</li>
<li><strong>eps</strong> (<em>float</em>) &#8211; A threshold for the renormalization in the Gram-Schmidt procedure</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The projection is based on the Modified Gram-Schmidt (MGS) process. In
each iteration of the MGS, a renormalization is carried out. If the norm
in this step is smaller than <code class="docutils literal"><span class="pre">eps</span></code>, an error is raised.</p>
<p>Note that <code class="docutils literal"><span class="pre">exp1</span></code> will be incomplete in several ways. The orbital
energies are not copied. Only the occupied orbitals in <code class="docutils literal"><span class="pre">exp0</span></code> are
projected. Coefficients of higher orbitals are set to zero. The orbital
occupations are simply copied. This should be sufficient to construct
an initial guess in a new orbital basis set based on a previous solution.</p>
<p>If the number of orbitals in <code class="docutils literal"><span class="pre">exp1</span></code> is too small to store all projected
orbitals, an error is raised.</p>
</dd></dl>

<dl class="function">
<dt id="horton.meanfield.project.project_orbitals_ortho">
<code class="descclassname">horton.meanfield.project.</code><code class="descname">project_orbitals_ortho</code><span class="sig-paren">(</span><em>olp0</em>, <em>olp1</em>, <em>exp0</em>, <em>exp1</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.project.project_orbitals_ortho" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-orthogonalize the orbitals .</p>
<p>The orbitals in <code class="docutils literal"><span class="pre">exp0</span></code> (w.r.t. <code class="docutils literal"><span class="pre">obasis0</span></code>) are re-orthonormalized w.r.t.
<code class="docutils literal"><span class="pre">obasis1</span></code> and stored in <code class="docutils literal"><span class="pre">exp1</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>olp0</strong> (<em>TwoIndex or GOBasis</em>) &#8211; The overlap matrix (or alternatively the orbital basis) for the original
wavefunction expansion.</li>
<li><strong>olp1</strong> (<em>TwoIndex or GOBasis</em>) &#8211; The overlap matrix (or alternatively the orbital basis) for the projected
wavefunction expansion.</li>
<li><strong>exp0</strong> (<a class="reference internal" href="mod_horton_matrix_dense.html#horton.matrix.dense.DenseExpansion" title="horton.matrix.dense.DenseExpansion"><em>DenseExpansion</em></a>) &#8211; The expansion of the original orbitals.</li>
<li><strong>exp1</strong> (<a class="reference internal" href="mod_horton_matrix_dense.html#horton.matrix.dense.DenseExpansion" title="horton.matrix.dense.DenseExpansion"><em>DenseExpansion</em></a>) &#8211; An output argument in which the projected orbitals will be stored.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This projection just transforms the old orbitals to an orthogonal basis
by a multiplication with the square root of the old overlap matrix. The
orbitals in this basis are then again multiplied with the inverse square
root of the new overlap matrix:</p>
<div class="math">
\[C_\text{new} = S_\text{new}^{-1/2} S_\text{old}^{1/2} C_\text{old}\]</div>
<p>This guarantees that <span class="math">\(C_\text{new}^T S_\text{new} C_\text{new} = I\)</span>
if <span class="math">\(C_\text{old}^T S_\text{old} C_\text{old} = I\)</span>. This approach is
simple and robust but the current implementation has some limitations: it
only works for projections between basis sets of the same size and it
assumes that there is some similarity between the new and old
orthogonalized atomic basis sets. The latter is only the case when the
old and new atomic basis sets are very similar, e.g. for small geometric
changes.</p>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mod_horton_meanfield_response.html" class="btn btn-neutral float-right" title="3.9.12. horton.meanfield.response – Evaluation of response functions" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mod_horton_meanfield_occ.html" class="btn btn-neutral" title="3.9.10. horton.meanfield.occ – Occupation number models" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div>Documentation for HORTON 2.0.0 built from release 2.0.0-244-gaaf5e2b. </div>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2011-2015, The HORTON Development Team.
      Last updated on Jun 16, 2016.
    </p>
  </div>

  <div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.0.0-244-gaaf5e2b',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>