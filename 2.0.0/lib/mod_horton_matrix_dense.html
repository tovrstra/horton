

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.8.4. horton.matrix.dense – Dense matrix implementations &mdash; HORTON 2.0.0-244-gaaf5e2b documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
    <link rel="top" title="HORTON 2.0.0-244-gaaf5e2b documentation" href="../index.html"/>
        <link rel="up" title="3.8. horton.matrix – One-, two-, three- and four-dimensional matrix implementations" href="pck_horton_matrix.html"/>
        <link rel="next" title="3.8.5. horton/matrix/slicing.h – Low-level routines for CholeskyLinalgFactory" href="mod_horton_matrix_slicing_h.html"/>
        <link rel="prev" title="3.8.3. horton.matrix.cholesky – Cholesky decomposition of four-index objects" href="mod_horton_matrix_cholesky.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/horton.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro_horton_overview.html">1. HORTON Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_citing_horton.html">2. Citing HORTON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_license_information.html">3. License Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_contact_information.html">4. Contact Information</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_download_and_install.html">1. Download and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_getting_started.html">2. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_hamiltonian.html">3. Hamiltonians</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_estruct.html">4. Electronic Structure Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_postproc.html">5. Post-processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_other.html">6. Other Topics</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical stuff</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tech_dev.html">1. Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tech_ref.html">2. Reference Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tech_api.html">3. API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pck_horton.html">3.1. <code class="docutils literal"><span class="pre">horton</span></code> &#8211; The main HORTON Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_correlatedwfn.html">3.2. <code class="docutils literal"><span class="pre">horton.correlatedwfn</span></code> &#8211; Methods for correlated wavefunctions</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_espfit.html">3.3. <code class="docutils literal"><span class="pre">horton.espfit</span></code> &#8211; Electrostatic potential fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_gbasis.html">3.4. <code class="docutils literal"><span class="pre">horton.gbasis</span></code> &#8211; Gaussian basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_grid.html">3.5. <code class="docutils literal"><span class="pre">horton.grid</span></code> &#8211; Numerical integration grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_io.html">3.6. <code class="docutils literal"><span class="pre">horton.io</span></code> &#8211; Input and output routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_localization.html">3.7. <code class="docutils literal"><span class="pre">horton.localization</span></code> &#8211; Methods for orbital localization</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="pck_horton_matrix.html">3.8. <code class="docutils literal"><span class="pre">horton.matrix</span></code> &#8211; One-, two-, three- and four-dimensional matrix implementations</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mod_horton_matrix_base.html">3.8.1. <code class="docutils literal"><span class="pre">horton.matrix.base</span></code> &#8211; Base classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_matrix_cext.html">3.8.2. <code class="docutils literal"><span class="pre">horton.matrix.cext</span></code> &#8211; C++ extensions for matrix package</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_matrix_cholesky.html">3.8.3. <code class="docutils literal"><span class="pre">horton.matrix.cholesky</span></code> &#8211; Cholesky decomposition of four-index objects</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.8.4. <code class="docutils literal"><span class="pre">horton.matrix.dense</span></code> &#8211; Dense matrix implementations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#naming-scheme-for-the-contract-slice-or-expand-methods">3.8.4.1. Naming scheme for the contract, slice or expand methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="#handling-of-index-symmetry">3.8.4.2. Handling of index symmetry</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dense-matrix-classes">3.8.4.3. Dense matrix classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_matrix_slicing_h.html">3.8.5. <code class="docutils literal"><span class="pre">horton/matrix/slicing.h</span></code> &#8211; Low-level routines for <code class="docutils literal"><span class="pre">CholeskyLinalgFactory</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_meanfield.html">3.9. <code class="docutils literal"><span class="pre">horton.meanfield</span></code> &#8211; Mean-field electronic structure code</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_modelhamiltonians.html">3.10. <code class="docutils literal"><span class="pre">horton.modelhamiltonians</span></code> &#8211; Model Hamiltonians</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_orbital_entanglement.html">3.11. <code class="docutils literal"><span class="pre">horton.orbital_entanglement</span></code> &#8211; Methods for measuring orbital entanglement</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_part.html">3.12. <code class="docutils literal"><span class="pre">horton.part</span></code> &#8211; Density-based partitioning (fuzzy atoms-in-molecules) package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_scripts.html">3.13. <code class="docutils literal"><span class="pre">horton.scripts</span></code> &#8211; Code (solely) used by HORTON&#8217;s command line scripts</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">HORTON</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../tech_api.html">3. API Documentation</a> &raquo;</li>
      
          <li><a href="pck_horton_matrix.html">3.8. <code class="docutils literal"><span class="pre">horton.matrix</span></code> &#8211; One-, two-, three- and four-dimensional matrix implementations</a> &raquo;</li>
      
    <li>3.8.4. <code class="docutils literal"><span class="pre">horton.matrix.dense</span></code> &#8211; Dense matrix implementations</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/lib/mod_horton_matrix_dense.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-horton.matrix.dense">
<span id="horton-matrix-dense-dense-matrix-implementations"></span><h1>3.8.4. <code class="docutils literal"><span class="pre">horton.matrix.dense</span></code> &#8211; Dense matrix implementations<a class="headerlink" href="#module-horton.matrix.dense" title="Permalink to this headline">¶</a></h1>
<div class="section" id="naming-scheme-for-the-contract-slice-or-expand-methods">
<h2>3.8.4.1. Naming scheme for the contract, slice or expand methods<a class="headerlink" href="#naming-scheme-for-the-contract-slice-or-expand-methods" title="Permalink to this headline">¶</a></h2>
<p>The name of <code class="docutils literal"><span class="pre">contract</span></code>, <code class="docutils literal"><span class="pre">slice</span></code> and <code class="docutils literal"><span class="pre">expand</span></code> methods is as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">iadd_</span><span class="p">]{</span><span class="n">contract</span><span class="p">,</span><span class="nb">slice</span><span class="p">,</span><span class="n">expand</span><span class="p">}[</span><span class="n">_X</span><span class="p">][</span><span class="n">_Y</span><span class="p">][</span><span class="n">_to_Z</span><span class="p">]</span>
</pre></div>
</div>
<p>where each part between square brackets is optional. <code class="docutils literal"><span class="pre">X</span></code>, <code class="docutils literal"><span class="pre">Y</span></code> and <code class="docutils literal"><span class="pre">Z</span></code>
can be any of <code class="docutils literal"><span class="pre">one</span></code>, <code class="docutils literal"><span class="pre">two</span></code>, <code class="docutils literal"><span class="pre">three</span></code> or <code class="docutils literal"><span class="pre">four</span></code>. The names
<code class="docutils literal"><span class="pre">contract</span></code>, <code class="docutils literal"><span class="pre">slice</span></code> and <code class="docutils literal"><span class="pre">expand</span></code> have the following meaning:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">contract</span></code></dt>
<dd>Some actual contraction takes place, i.e. summing of (products) of
matrix elements.</dd>
<dt><code class="docutils literal"><span class="pre">slice</span></code></dt>
<dd>A subset of the elements is merely selected, without any addition of
elements. This is never combined with <code class="docutils literal"><span class="pre">iadd_</span></code>.</dd>
<dt><code class="docutils literal"><span class="pre">expand</span></code></dt>
<dd>Products of elements are computed but these products are not added.
Similar to an outer product but more general.</dd>
</dl>
<p>When <code class="docutils literal"><span class="pre">iadd_</span></code> is used as a prefix, the result of the contraction is added
in-place to the self object. In this case, the <code class="docutils literal"><span class="pre">_to_Z</span></code> part is never
present. A contraction of all input arguments is made. The dimensionality
of the input arguments is indicated by <code class="docutils literal"><span class="pre">_X</span></code> and <code class="docutils literal"><span class="pre">_Y</span></code>.</p>
<p>When <code class="docutils literal"><span class="pre">_to_Z</span></code> is present, the contraction involves self and possibly other
arguments whose dimensionality is indicated by <code class="docutils literal"><span class="pre">_X</span></code> and <code class="docutils literal"><span class="pre">_Y</span></code>. In this
case, <code class="docutils literal"><span class="pre">iadd_</span></code> can not be present. The result is written to an output
argument. If the output argument is not provided, fresh memory is allocated
to compute the contraction and the result is returned. (This allocation is
provided for convenience but should not be used in critical situations.)</p>
<p>Some remarks:</p>
<ul class="simple">
<li>Similar conventions apply to an <code class="docutils literal"><span class="pre">expand</span></code> method.</li>
<li>All <code class="docutils literal"><span class="pre">contract</span></code> and <code class="docutils literal"><span class="pre">expand</span></code> methods are implemented with the driver
method <code class="docutils literal"><span class="pre">DenseLinalgFactory.einsum</span></code>. However, other implementations than
<cite>Dense</cite> are free to implement things differently.</li>
<li>All <code class="docutils literal"><span class="pre">contract</span></code> and <code class="docutils literal"><span class="pre">expand</span></code> methods never touch the internals of
higher-index objects.</li>
</ul>
<p>For more specific information, read the documentation of the individual
classes and methods below.</p>
</div>
<div class="section" id="handling-of-index-symmetry">
<span id="dense-matrix-symmetry"></span><h2>3.8.4.2. Handling of index symmetry<a class="headerlink" href="#handling-of-index-symmetry" title="Permalink to this headline">¶</a></h2>
<p>The dense matrix classes do not exploit matrix symmetry to reduce memory
needs. Instead they will happily store non-symmetric data if need be. There
are however a few methods in the <a class="reference internal" href="#horton.matrix.dense.DenseTwoIndex" title="horton.matrix.dense.DenseTwoIndex"><code class="xref py py-class docutils literal"><span class="pre">DenseTwoIndex</span></code></a> and
<a class="reference internal" href="#horton.matrix.dense.DenseFourIndex" title="horton.matrix.dense.DenseFourIndex"><code class="xref py py-class docutils literal"><span class="pre">DenseFourIndex</span></code></a> classes below that take a <code class="docutils literal"><span class="pre">symmetry</span></code> argument to
check or enforce a certain index symmetry.</p>
<p>The symmetry argument is always an integer that corresponds to the redundancy
of the off-diagonal matrix elements in the dense storage. In practice this
means the following:</p>
<ul class="simple">
<li><a class="reference internal" href="#horton.matrix.dense.DenseTwoIndex" title="horton.matrix.dense.DenseTwoIndex"><code class="xref py py-class docutils literal"><span class="pre">DenseTwoIndex</span></code></a><ul>
<li><code class="docutils literal"><span class="pre">symmetry=1</span></code>: Nothing is checked/enforced</li>
<li><code class="docutils literal"><span class="pre">symmetry=2</span></code>: Hermitian index symmetry is
checked/enforced (default), i.e. <span class="math">\(\langle i \vert A \vert j
\rangle = ` :math:\)</span>langle j vert A vert i rangle`</li>
</ul>
</li>
<li><a class="reference internal" href="#horton.matrix.dense.DenseFourIndex" title="horton.matrix.dense.DenseFourIndex"><code class="xref py py-class docutils literal"><span class="pre">DenseFourIndex</span></code></a><ul>
<li><code class="docutils literal"><span class="pre">symmetry=1</span></code>: Nothing is checked/enforced</li>
<li><code class="docutils literal"><span class="pre">symmetry=2</span></code>: Dummy index symmetry is
checked/enforced, i.e.
<span class="math">\(\langle ij \vert B \vert kl \rangle =\)</span>
<span class="math">\(\langle ji \vert B \vert lk \rangle\)</span></li>
<li><code class="docutils literal"><span class="pre">symmetry=4</span></code>: Hermitian and real index symmetry are checked/enforced,
i.e.
<span class="math">\(\langle ij \vert B \vert kl \rangle =\)</span>
<span class="math">\(\langle kl \vert B \vert ij \rangle =\)</span>
<span class="math">\(\langle kj \vert B \vert il \rangle =\)</span>
<span class="math">\(\langle il \vert B \vert kj \rangle\)</span>.
(This only makes sense because the basis functions are assumed to be
real.)</li>
<li><code class="docutils literal"><span class="pre">symmetry=8</span></code>: All possible symmetries are checked/enforced, i.e.
<span class="math">\(\langle ij \vert B \vert kl \rangle =\)</span>
<span class="math">\(\langle kl \vert B \vert ij \rangle =\)</span>
<span class="math">\(\langle kj \vert B \vert il \rangle =\)</span>
<span class="math">\(\langle il \vert B \vert kj \rangle =\)</span>
<span class="math">\(\langle ji \vert B \vert lk \rangle =\)</span>
<span class="math">\(\langle lk \vert B \vert ji \rangle =\)</span>
<span class="math">\(\langle jk \vert B \vert li \rangle =\)</span>
<span class="math">\(\langle li \vert B \vert jk \rangle\)</span>.
(This only makes sense because the basis functions are assumed to be
real.)</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="dense-matrix-classes">
<h2>3.8.4.3. Dense matrix classes<a class="headerlink" href="#dense-matrix-classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="horton.matrix.dense.DenseLinalgFactory">
<em class="property">class </em><code class="descclassname">horton.matrix.dense.</code><code class="descname">DenseLinalgFactory</code><span class="sig-paren">(</span><em>default_nbasis=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseLinalgFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mod_horton_matrix_base.html#horton.matrix.base.LinalgFactory" title="horton.matrix.base.LinalgFactory"><code class="xref py py-class docutils literal"><span class="pre">horton.matrix.base.LinalgFactory</span></code></a></p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>default_nbasis</dt>
<dd>The default basis size when constructing new
operators/expansions.</dd>
</dl>
<dl class="method">
<dt id="horton.matrix.dense.DenseLinalgFactory.create_expansion">
<code class="descname">create_expansion</code><span class="sig-paren">(</span><em>nbasis=None</em>, <em>nfn=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseLinalgFactory.create_expansion" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a DenseExpansion with defaults from the LinalgFactory</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions. When not given, the
default_nbasis value of the DenseLinalgFactory instance will be
used.</dd>
<dt>nfn</dt>
<dd>The number of orbitals. When not given, the default_nbasis
value of the DenseLinalgFactory instance will be used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseLinalgFactory.create_four_index">
<code class="descname">create_four_index</code><span class="sig-paren">(</span><em>nbasis=None</em>, <em>nbasis1=None</em>, <em>nbasis2=None</em>, <em>nbasis3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseLinalgFactory.create_four_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a DenseFourIndex with defaults from the LinalgFactory</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions. When not given, the
default_nbasis value of the DenseLinalgFactory instance will be
used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseLinalgFactory.create_one_index">
<code class="descname">create_one_index</code><span class="sig-paren">(</span><em>nbasis=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseLinalgFactory.create_one_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a DenseOneIndex with defaults from the LinalgFactory</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions. When not given, the
default_nbasis value of the DenseLinalgFactory instance will be
used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseLinalgFactory.create_three_index">
<code class="descname">create_three_index</code><span class="sig-paren">(</span><em>nbasis=None</em>, <em>nbasis1=None</em>, <em>nbasis2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseLinalgFactory.create_three_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a DenseThreeIndex with defaults from the LinalgFactory</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions. When not given, the
default_nbasis value of the DenseLinalgFactory instance will be
used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseLinalgFactory.create_two_index">
<code class="descname">create_two_index</code><span class="sig-paren">(</span><em>nbasis=None</em>, <em>nbasis1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseLinalgFactory.create_two_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a DenseTwoIndex with defaults from the LinalgFactory</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions. When not given, the
default_nbasis value of the DenseLinalgFactory instance will be
used.</dd>
<dt>nbasis1</dt>
<dd>The number of basis functions for the second axis if it differes
from <code class="docutils literal"><span class="pre">nbasis</span></code>.</dd>
</dl>
</dd></dl>

<dl class="staticmethod">
<dt id="horton.matrix.dense.DenseLinalgFactory.einsum">
<em class="property">static </em><code class="descname">einsum</code><span class="sig-paren">(</span><em>subscripts</em>, <em>out</em>, <em>factor</em>, <em>clear</em>, <em>*operands</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="Permalink to this definition">¶</a></dt>
<dd><p>einsum wrapper for DenseNBody objects</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd>The usual subscripts argument for the einsum function, except
that the format is slightly limited. All indexes must be
explicitly stated. If the output argument is a scalar, <code class="docutils literal"><span class="pre">-&gt;</span></code>
may not be present. In all other cases, <code class="docutils literal"><span class="pre">-&gt;</span></code> must be present.</dd>
<dt>out</dt>
<dd>An output DenseNBody object. This argument is not allowed when
the result is a scalar.</dd>
<dt>factor</dt>
<dd>Multiply the contraction by a scalar factor.</dd>
<dt>clear</dt>
<dd>When set to False, the output argument is not zeroed before
adding the contraction.</dd>
<dt>operands</dt>
<dd>A list where each element is (i) a DenseNBody object or (ii) a
two-tuple of DenseNBody object and ranges to select for slicing.
The ranges must be a tuple of integers of the form (begin0,
end0, begin1, end1, ...) where the number of (begin, end) pairs
depends on the dimensionality of the corresponding tensor.</dd>
</dl>
<p><strong>Returns:</strong> the out object. When the out argument is given, this is
returned with in-place modifications.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseLinalgFactory.from_hdf5">
<code class="descname">from_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseLinalgFactory.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an instance from data previously stored in an h5py.Group.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>An h5py.Group object.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseLinalgFactory.set_default_nbasis">
<code class="descname">set_default_nbasis</code><span class="sig-paren">(</span><em>nbasis</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseLinalgFactory.set_default_nbasis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="horton.matrix.dense.DenseLinalgFactory.tensordot">
<em class="property">static </em><code class="descname">tensordot</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>axes</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseLinalgFactory.tensordot" title="Permalink to this definition">¶</a></dt>
<dd><p>tensordot wrapper for dense n-index objects.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>a, b, axes</dt>
<dd>See documentation of numpy.tensordot</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out</dt>
<dd>The output argument, an instance of one of the Dense?Index classes.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseLinalgFactory.to_hdf5">
<code class="descname">to_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseLinalgFactory.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a LinalgFactory to an HDF5 group</p>
<p><strong>Argument:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>A h5py.Group instance to write to.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.dense.DenseOneIndex">
<em class="property">class </em><code class="descclassname">horton.matrix.dense.</code><code class="descname">DenseOneIndex</code><span class="sig-paren">(</span><em>nbasis</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mod_horton_matrix_base.html#horton.matrix.base.OneIndex" title="horton.matrix.base.OneIndex"><code class="xref py py-class docutils literal"><span class="pre">horton.matrix.base.OneIndex</span></code></a></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions.</dd>
</dl>
<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.assign">
<code class="descname">assign</code><span class="sig-paren">(</span><em>other</em>, <em>begin0=0</em>, <em>end0=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.assign" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign with the contents of another object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>Another DenseOneIndex object or a scalar.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>begin0, end0</dt>
<dd>If specified, only a sublock of self is assigned.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.change_basis_signs">
<code class="descname">change_basis_signs</code><span class="sig-paren">(</span><em>signs</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.change_basis_signs" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for different sign conventions of the basis functions.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>signs</dt>
<dd>A numpy array with sign changes indicated by +1 and -1.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all elements to zero.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>begin=0</em>, <em>end=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of (a part of) the object</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>begin, end</dt>
<dd>Can be used to select a subblock of the object. When not given,
the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.divide">
<code class="descname">divide</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em>, <em>out=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.divide" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide two DenseOneIndex object, multiplied by factor, and return
output</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseOneIndex instance to be divided</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>A scalar factor</dd>
<dt>out</dt>
<dd>The output DenseOneIndex</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.dot">
<code class="descname">dot</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Dot product with other DenseOneIndex object, multiplied by factor</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseOneIndex instance to be added</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>A scalar factor</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="horton.matrix.dense.DenseOneIndex.from_hdf5">
<em class="property">classmethod </em><code class="descname">from_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an instance from data previously stored in an h5py.Group.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>An h5py.Group object.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.get_element">
<code class="descname">get_element</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.get_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a matrix element</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.get_max">
<code class="descname">get_max</code><span class="sig-paren">(</span><em>abs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.get_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return maximum (absolute) element</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.iadd">
<code class="descname">iadd</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.iadd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add another DenseOneIndex object in-place, multiplied by factor</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseOneIndex instance to be added</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>A scalar factor</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.iscale">
<code class="descname">iscale</code><span class="sig-paren">(</span><em>factor</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.iscale" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place multiplication with a scalar</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>A scalar factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.mult">
<code class="descname">mult</code><span class="sig-paren">(</span><em>other</em>, <em>out=None</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.mult" title="Permalink to this definition">¶</a></dt>
<dd><p>Muliply with other DenseOneIndex object, multiplied by factor</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseOneIndex instance to be added</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out</dt>
<dd>The output argument (DenseOneIndex with proper size).</dd>
<dt>factor</dt>
<dd>A scalar factor</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.new">
<code class="descname">new</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.new" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new one-index object with the same nbasis</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.norm">
<code class="descname">norm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate L2 norm</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.permute_basis">
<code class="descname">permute_basis</code><span class="sig-paren">(</span><em>permutation</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.permute_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder the coefficients for a given permutation of basis functions.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>permutation</dt>
<dd>An integer numpy array that defines the new order of the basis
functions.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.randomize">
<code class="descname">randomize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill with random normal data</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.set_element">
<code class="descname">set_element</code><span class="sig-paren">(</span><em>i</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.set_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a matrix element</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.sort_indices">
<code class="descname">sort_indices</code><span class="sig-paren">(</span><em>reverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.sort_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return indices of sorted arguments in decreasing order</p>
<p><strong>Optional arguements</strong></p>
<dl class="docutils">
<dt>reverse</dt>
<dd>If True search order is reversed to increasing arguements</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.to_hdf5">
<code class="descname">to_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump this object in an h5py.Group</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>An h5py.Group object.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseOneIndex.trace">
<code class="descname">trace</code><span class="sig-paren">(</span><em>begin0=0</em>, <em>end0=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate trace</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>begin0, end0</dt>
<dd>Can be used to select a subblock of the object. When not given,
the full range is used.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseOneIndex.nbasis">
<code class="descname">nbasis</code><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.nbasis" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseOneIndex.ndim">
<code class="descname">ndim</code><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of axes in the N-index object.</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseOneIndex.shape">
<code class="descname">shape</code><a class="headerlink" href="#horton.matrix.dense.DenseOneIndex.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the object</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.dense.DenseExpansion">
<em class="property">class </em><code class="descclassname">horton.matrix.dense.</code><code class="descname">DenseExpansion</code><span class="sig-paren">(</span><em>nbasis</em>, <em>nfn=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mod_horton_matrix_base.html#horton.matrix.base.Expansion" title="horton.matrix.base.Expansion"><code class="xref py py-class docutils literal"><span class="pre">horton.matrix.base.Expansion</span></code></a></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>nfn</dt>
<dd>The number of functions to store. Defaults to nbasis.</dd>
<dt>do_energies</dt>
<dd>Also allocate an array to store an energy corresponding to each
function.</dd>
</dl>
<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.assign">
<code class="descname">assign</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.assign" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign with the contents of another object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>Another DenseExpansion or DenseTwoIndex object.
If DenseTwoIndex, energies and occupations are set to zero.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.assign_dot">
<code class="descname">assign_dot</code><span class="sig-paren">(</span><em>left</em>, <em>right</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.assign_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Dot product of orbitals in a DenseExpansion and TwoIndex object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>left, right:</dt>
<dd>An expansion and a two-index object, or a two-index and an expansion
object.</dd>
</dl>
<p>The transformed orbitals are stored in self.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.assign_occupations">
<code class="descname">assign_occupations</code><span class="sig-paren">(</span><em>occupation</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.assign_occupations" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign orbital occupations</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>occupation</dt>
<dd>The orbital occupations to be updated. An OneIndex instance</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.change_basis_signs">
<code class="descname">change_basis_signs</code><span class="sig-paren">(</span><em>signs</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.change_basis_signs" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for different sign conventions of the basis functions.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>signs</dt>
<dd>A numpy array with sign changes indicated by +1 and -1.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.check_normalization">
<code class="descname">check_normalization</code><span class="sig-paren">(</span><em>overlap</em>, <em>eps=0.0001</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.check_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the occupied orbitals are normalized.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>overlap</dt>
<dd>The overlap two-index operator</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>eps</dt>
<dd>The allowed deviation from unity, very loose by default.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.check_orthonormality">
<code class="descname">check_orthonormality</code><span class="sig-paren">(</span><em>overlap</em>, <em>eps=0.0001</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.check_orthonormality" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the occupied orbitals are orthogonal and normalized.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>overlap</dt>
<dd>The overlap two-index operator</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>eps</dt>
<dd>The allowed deviation from unity, very loose by default.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all elements to zero.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of the object</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.derive_naturals">
<code class="descname">derive_naturals</code><span class="sig-paren">(</span><em>dm</em>, <em>overlap</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.derive_naturals" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Arguments</strong>:</p>
<dl class="docutils">
<dt>dm</dt>
<dd>A DenseTwoIndex object with the density matrix</dd>
<dt>overlap</dt>
<dd>A DenseTwoIndex object with the overlap matrix</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.error_eigen">
<code class="descname">error_eigen</code><span class="sig-paren">(</span><em>fock</em>, <em>overlap</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.error_eigen" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the error of the orbitals with respect to the eigenproblem</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>fock</dt>
<dd>A DenseTwoIndex Hamiltonian (or Fock) operator.</dd>
<dt>overlap</dt>
<dd>A DenseTwoIndex overlap operator.</dd>
</dl>
<p><strong>Returns:</strong> the RMSD error on the orbital energies</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.from_fock">
<code class="descname">from_fock</code><span class="sig-paren">(</span><em>fock</em>, <em>overlap</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.from_fock" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonalize a Fock matrix to obtain orbitals and energies</p>
<p>This method updated the attributes <code class="docutils literal"><span class="pre">coeffs</span></code> and <code class="docutils literal"><span class="pre">energies</span></code>
in-place.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>fock</dt>
<dd>The fock matrix, an instance of DenseTwoIndex.</dd>
<dt>overlap</dt>
<dd>The overlap matrix, an instance of DenseTwoIndex.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.from_fock_and_dm">
<code class="descname">from_fock_and_dm</code><span class="sig-paren">(</span><em>fock</em>, <em>dm</em>, <em>overlap</em>, <em>epstol=1e-08</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.from_fock_and_dm" title="Permalink to this definition">¶</a></dt>
<dd><p>Combined Diagonalization of a Fock and a density matrix</p>
<p>This routine first diagonalizes the Fock matrix to obtain orbitals
and orbital energies. Then, using first order (degenerate)
perturbation theory, the occupation numbers are computed and, if
needed, the the degeneracies of the Fock orbitals are lifted.
It is assumed that the Fock and the density matrices commute.
This method updated the attributes <code class="docutils literal"><span class="pre">coeffs</span></code>, <code class="docutils literal"><span class="pre">energies</span></code> and
<code class="docutils literal"><span class="pre">occupations</span></code> in-place.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>fock</dt>
<dd>The fock matrix, an instance of DenseTwoIndex.</dd>
<dt>dm</dt>
<dd>The density matrix, an instance of DenseTwoIndex.</dd>
<dt>overlap</dt>
<dd>The overlap matrix, an instance of DenseTwoIndex.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>epstol</dt>
<dd>The threshold for recognizing degenerate energy levels. When two
subsequent energy levels are separated by an orbital energy less
than <code class="docutils literal"><span class="pre">epstol</span></code>, they are considered to be degenerate. When a
series of energy levels have an orbital energy spacing between
subsequent levels that is smaller than <code class="docutils literal"><span class="pre">epstol</span></code>, they are all
considered to be part of the same degenerate group. For every
degenerate set of orbitals, the density matrix is used to (try
to) lift the degeneracy.</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="horton.matrix.dense.DenseExpansion.from_hdf5">
<em class="property">classmethod </em><code class="descname">from_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an instance from data previously stored in an h5py.Group.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>An h5py.Group object.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.get_homo_energy">
<code class="descname">get_homo_energy</code><span class="sig-paren">(</span><em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.get_homo_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a homo energy</p>
<p><strong>Optional arguments</strong>:</p>
<dl class="docutils">
<dt>offset</dt>
<dd>By default, the (highest) homo energy is returned. When this
index is above zero, the corresponding lower homo energy is
returned.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.get_homo_index">
<code class="descname">get_homo_index</code><span class="sig-paren">(</span><em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.get_homo_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of a HOMO orbital.</p>
<p><strong>Optional arguments</strong>:</p>
<dl class="docutils">
<dt>offset</dt>
<dd>By default, the (highest) homo energy is returned. When this
index is above zero, the corresponding lower homo energy is
returned.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.get_lumo_energy">
<code class="descname">get_lumo_energy</code><span class="sig-paren">(</span><em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.get_lumo_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a lumo energy</p>
<p><strong>Optional arguments</strong>:</p>
<dl class="docutils">
<dt>offset</dt>
<dd>By default, the (lowest) lumo energy is returned. When this
index is above zero, the corresponding higher homo energy is
returned.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.get_lumo_index">
<code class="descname">get_lumo_index</code><span class="sig-paren">(</span><em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.get_lumo_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of a LUMO orbital.</p>
<p><strong>Optional arguments</strong>:</p>
<dl class="docutils">
<dt>offset</dt>
<dd>By default, the (lowest) lumo energy is returned. When this
index is above zero, the corresponding higher homo energy is
returned.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.imul">
<code class="descname">imul</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.imul" title="Permalink to this definition">¶</a></dt>
<dd><p>Inplace multiplication with other DenseOneIndex.</p>
<p>The attributes <code class="docutils literal"><span class="pre">energies</span></code> and <code class="docutils literal"><span class="pre">occupations</span></code> are not altered.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseOneIndex object.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.itranspose">
<code class="descname">itranspose</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.itranspose" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place transpose</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.new">
<code class="descname">new</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.new" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new expansion object with the same nbasis and nfn</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.permute_basis">
<code class="descname">permute_basis</code><span class="sig-paren">(</span><em>permutation</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.permute_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder the coefficients for a given permutation of basis functions
(rows).</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>permutation</dt>
<dd>An integer numpy array that defines the new order of the basis
functions.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.permute_orbitals">
<code class="descname">permute_orbitals</code><span class="sig-paren">(</span><em>permutation</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.permute_orbitals" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder the coefficients for a given permutation of orbitals
(columns).</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>permutation</dt>
<dd>An integer numpy array that defines the new order of the
orbitals.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.randomize">
<code class="descname">randomize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill with random normal data</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.rotate_2orbitals">
<code class="descname">rotate_2orbitals</code><span class="sig-paren">(</span><em>angle=0.7853981633974483</em>, <em>index0=None</em>, <em>index1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.rotate_2orbitals" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate two orbitals</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>angle</dt>
<dd>The rotation angle, defaults to 45 deg.</dd>
<dt>index0, index1</dt>
<dd>The orbitals to rotate, defaults to HOMO and LUMO,</dd>
</dl>
<p>The attributes <code class="docutils literal"><span class="pre">energies</span></code> and <code class="docutils literal"><span class="pre">occupations</span></code> are not altered.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.rotate_random">
<code class="descname">rotate_random</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.rotate_random" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply random unitary transformation distributed with Haar measure</p>
<p>The attributes <code class="docutils literal"><span class="pre">energies</span></code> and <code class="docutils literal"><span class="pre">occupations</span></code> are not altered.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.swap_orbitals">
<code class="descname">swap_orbitals</code><span class="sig-paren">(</span><em>swaps</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.swap_orbitals" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the order of the orbitals using pair-exchange</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>swaps</dt>
<dd>An integer numpy array with two columns where every row
corresponds to one swap.</dd>
</dl>
<p>The attributes <code class="docutils literal"><span class="pre">energies</span></code> and <code class="docutils literal"><span class="pre">occupations</span></code> are also reordered.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.to_dm">
<code class="descname">to_dm</code><span class="sig-paren">(</span><em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>other=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.to_dm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the density matrix</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out</dt>
<dd>An output density matrix (DenseTwoIndex instance).</dd>
<dt>factor</dt>
<dd>The density matrix is multiplied by the given scalar.</dd>
<dt>clear</dt>
<dd>When set to False, the output density matrix is not zeroed
first.</dd>
<dt>other</dt>
<dd>Another DenseExpansion object to construct a transfer-density
matrix.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseExpansion.to_hdf5">
<code class="descname">to_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump this object in an h5py.Group</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>An h5py.Group object.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseExpansion.coeffs">
<code class="descname">coeffs</code><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>The matrix with the expansion coefficients</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseExpansion.energies">
<code class="descname">energies</code><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.energies" title="Permalink to this definition">¶</a></dt>
<dd><p>The orbital energies</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseExpansion.homo_energy">
<code class="descname">homo_energy</code><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.homo_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a homo energy</p>
<p><strong>Optional arguments</strong>:</p>
<dl class="docutils">
<dt>offset</dt>
<dd>By default, the (highest) homo energy is returned. When this
index is above zero, the corresponding lower homo energy is
returned.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseExpansion.lumo_energy">
<code class="descname">lumo_energy</code><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.lumo_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a lumo energy</p>
<p><strong>Optional arguments</strong>:</p>
<dl class="docutils">
<dt>offset</dt>
<dd>By default, the (lowest) lumo energy is returned. When this
index is above zero, the corresponding higher homo energy is
returned.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseExpansion.nbasis">
<code class="descname">nbasis</code><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.nbasis" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseExpansion.nfn">
<code class="descname">nfn</code><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.nfn" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of orbitals (or functions in general)</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseExpansion.occupations">
<code class="descname">occupations</code><a class="headerlink" href="#horton.matrix.dense.DenseExpansion.occupations" title="Permalink to this definition">¶</a></dt>
<dd><p>The orbital occupations</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.dense.DenseTwoIndex">
<em class="property">class </em><code class="descclassname">horton.matrix.dense.</code><code class="descname">DenseTwoIndex</code><span class="sig-paren">(</span><em>nbasis</em>, <em>nbasis1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mod_horton_matrix_base.html#horton.matrix.base.TwoIndex" title="horton.matrix.base.TwoIndex"><code class="xref py py-class docutils literal"><span class="pre">horton.matrix.base.TwoIndex</span></code></a></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions. (Number of rows. Also number of
columns, unless nbasis1 is given.)</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>nbasis1</dt>
<dd>When given, this is the number of columns (second index).</dd>
</dl>
<p>Note that by default the two-index object is assumed to be Hermitian.
Only when nbasis1 is given, this assumption is dropped.</p>
<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.assign">
<code class="descname">assign</code><span class="sig-paren">(</span><em>other</em>, <em>ind=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.assign" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign a new contents to the two-index object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>The new data, may be DenseTwoIndex, DenseOneIndex, a scalar
value, or an ndarray.</dd>
<dt>ind</dt>
<dd>If provided, only these elements (of DenseOneIndex) are
assigned</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.assign_diagonal">
<code class="descname">assign_diagonal</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.assign_diagonal" title="Permalink to this definition">¶</a></dt>
<dd><p>Set diagonal elements to value</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>value</dt>
<dd>Either a scalar or a DenseOneIndex object</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.assign_dot">
<code class="descname">assign_dot</code><span class="sig-paren">(</span><em>other</em>, <em>tf2</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.assign_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Dot product of orbitals in a DenseExpansion and TwoIndex object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>An expansion object with input orbitals</dd>
<dt>tf2</dt>
<dd>A two-index object</dd>
</dl>
<p>The transformed array is stored in self.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.assign_two_index_transform">
<code class="descname">assign_two_index_transform</code><span class="sig-paren">(</span><em>ao_integrals</em>, <em>exp0</em>, <em>exp1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.assign_two_index_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform two index transformation: <code class="docutils literal"><span class="pre">exp0.T</span> <span class="pre">*</span> <span class="pre">ao_integrals</span> <span class="pre">*</span> <span class="pre">exp0</span></code></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>ao_integrals</dt>
<dd>Something computed in the atomic orbital basis</dd>
<dt>exp0</dt>
<dd>The molecular orbitals.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>exp1</dt>
<dd>When given, the following is computed: <code class="docutils literal"><span class="pre">exp0.T</span> <span class="pre">*</span> <span class="pre">ao_integrals</span> <span class="pre">*</span>
<span class="pre">exp1</span></code></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.change_basis_signs">
<code class="descname">change_basis_signs</code><span class="sig-paren">(</span><em>signs</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.change_basis_signs" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for different sign conventions of the basis functions.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>signs</dt>
<dd>A numpy array with sign changes indicated by +1 and -1.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all elements to zero.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.contract_to_one">
<code class="descname">contract_to_one</code><span class="sig-paren">(</span><em>subscripts</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.contract_to_one" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract self to OneIndex.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd><code class="docutils literal"><span class="pre">ab-&gt;b</span></code>: contract first index, <code class="docutils literal"><span class="pre">ab-&gt;a</span></code>: contract second
index.</dd>
</dl>
<p><strong>Optional arguments</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to contract only a part of the two-index object</dd>
</dl>
<p><strong>Returns:</strong> the contracted one-index object.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.contract_two">
<code class="descname">contract_two</code><span class="sig-paren">(</span><em>subscripts</em>, <em>two</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.contract_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the trace using with other two-index objects</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd><code class="docutils literal"><span class="pre">ab,ba</span></code>: trace of matrix product. <code class="docutils literal"><span class="pre">ab,ab</span></code>: trace after
element-wise multiplication (expectation_value).</dd>
<dt>two</dt>
<dd>A DenseTwoIndex instance</dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to select a subblock of the (other) object. When
not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.contract_two_to_one">
<code class="descname">contract_two_to_one</code><span class="sig-paren">(</span><em>subscripts</em>, <em>other</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.contract_two_to_one" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract two TwoIndex objects to a one OneIndex.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts:</dt>
<dd><code class="docutils literal"><span class="pre">ab,ab-&gt;b</span></code>: contract first index. <code class="docutils literal"><span class="pre">ab,ab-&gt;a</span></code>: contract
second index.</dd>
<dt>other</dt>
<dd>The second DenseTwoIndex object.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to contract only a part of the other two-index
object. When not given, the full range is taken.</dd>
</dl>
<p><strong>Returns:</strong> the contracted one-index object.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.contract_two_to_two">
<code class="descname">contract_two_to_two</code><span class="sig-paren">(</span><em>subscripts</em>, <em>other</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.contract_two_to_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract two TwoIndex objects to a one twoIndex.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts:</dt>
<dd><code class="docutils literal"><span class="pre">ab,cb-&gt;ac</span></code>, <code class="docutils literal"><span class="pre">ab,ca-&gt;cb</span></code>, <code class="docutils literal"><span class="pre">ab,bc-&gt;ac</span></code>, <code class="docutils literal"><span class="pre">ab,ac-&gt;cb</span></code>,
<code class="docutils literal"><span class="pre">ab,ac-&gt;bc</span></code>, <code class="docutils literal"><span class="pre">ab,cb-&gt;ca</span></code></dd>
<dt>other</dt>
<dd>The second DenseTwoIndex object.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to select a subblock of the (other) object. When
not given, the full range is used.</dd>
</dl>
<p><strong>Returns:</strong> the contracted two-index object.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of (a part of) the object</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to select a subblock of the object. When not given,
the full range is used. Only when the ranges are equal for both
axes, an Hermitian two-index may be returned.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.copy_diagonal">
<code class="descname">copy_diagonal</code><span class="sig-paren">(</span><em>out=None</em>, <em>begin=0</em>, <em>end=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.copy_diagonal" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy (part of) the diagonal of the two-index object</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out</dt>
<dd>The output argument (DenseOneIndex with proper size).</dd>
<dt>begin, end</dt>
<dd>Can be used to select a range of the diagonal. If not given,
then the entire diagonal is copied.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.copy_slice">
<code class="descname">copy_slice</code><span class="sig-paren">(</span><em>ind</em>, <em>out=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.copy_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy slice of the two-index object into one-index object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>ind</dt>
<dd>2-Tuple of 1-dim arrays with row and column indices of TwoIndex
object to be copied.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out</dt>
<dd>The output argument (DenseOneIndex with proper size).</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.diagonalize">
<code class="descname">diagonalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.diagonalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return eigenvalues of two-index object</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.distance_inf">
<code class="descname">distance_inf</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.distance_inf" title="Permalink to this definition">¶</a></dt>
<dd><p>The infinity norm distance between self and other</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseTwoIndex instance.</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="horton.matrix.dense.DenseTwoIndex.from_hdf5">
<em class="property">classmethod </em><code class="descname">from_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an instance from data previously stored in an h5py.Group.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>An h5py.Group object.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.get_element">
<code class="descname">get_element</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.get_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a matrix element</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iabs">
<code class="descname">iabs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iabs" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place absolute values</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd">
<code class="descname">iadd</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>transpose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add another DenseTwoIndex object in-place, multiplied by factor. If
begin0, end0, begin1, end1 are specified, other is added to the
selected range.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseTwoIndex, DenseOneIndex instance or float to be added</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>A scalar factor</dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>When given, specify the ranges where the contribution will be
added. When not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd_contract_two_one">
<code class="descname">iadd_contract_two_one</code><span class="sig-paren">(</span><em>subscripts</em>, <em>two</em>, <em>one</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd_contract_two_one" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place addition of a contraction of a two- and one-index object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>two, one</dt>
<dd>The two- and one-index objects, respectively. Instances of</dd>
<dt>subscripts</dt>
<dd><code class="docutils literal"><span class="pre">ab,b-&gt;ab</span></code>: contract with the first index of the two-index object.
<code class="docutils literal"><span class="pre">ab,a-&gt;ab</span></code>: contract with the second index of the two-index.
<code class="docutils literal"><span class="pre">ba,a-&gt;ab</span></code>: contract with the second index and transpose.
object.</dd>
<dt>factor</dt>
<dd>The term added is scaled by this factor.</dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to select a subblock of the two-index object (two).
When not given, the full range is used.</dd>
<dt>begin2, end2</dt>
<dd>Can be used to select a subblock of the one-index object (one).
When not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd_dot">
<code class="descname">iadd_dot</code><span class="sig-paren">(</span><em>other0</em>, <em>other1</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place addition of dot product: <code class="docutils literal"><span class="pre">other0</span> <span class="pre">*</span> <span class="pre">other1</span></code></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other0, other1</dt>
<dd>Two-index objects that go into the kronecker product.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The term added is scaled by this factor.</dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to select a subblock of the other0 object. When
not given, the full range is used.</dd>
<dt>begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the other1 object. When
not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd_dott">
<code class="descname">iadd_dott</code><span class="sig-paren">(</span><em>other0</em>, <em>other1</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd_dott" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place addition of dot product: <code class="docutils literal"><span class="pre">other0</span> <span class="pre">*</span> <span class="pre">other1.T</span></code></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other0, other1</dt>
<dd>Two-index objects that go into the kronecker product.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The term added is scaled by this factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd_kron">
<code class="descname">iadd_kron</code><span class="sig-paren">(</span><em>other0</em>, <em>other1</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd_kron" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place addition of kronecker product of two other DenseTwoIndex</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other0, other1</dt>
<dd>Two-index objects that go into the kronecker product.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The term added is scaled by this factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd_mult">
<code class="descname">iadd_mult</code><span class="sig-paren">(</span><em>other0</em>, <em>other1</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em>, <em>transpose0=False</em>, <em>transpose1=False</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd_mult" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place addition of multiplication: <code class="docutils literal"><span class="pre">other0</span> <span class="pre">*</span> <span class="pre">other1</span></code></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other0, other1</dt>
<dd>Two-index objects that go into the product.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The term added is scaled by this factor.</dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to select a subblock of the other1 object. When
not given, the full range is used.</dd>
<dt>begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the other0 object. When
not given, the full range is used.</dd>
<dt>transpose0, transpose1</dt>
<dd>Can be used to select transpose of other0, other1 objects</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd_one_mult">
<code class="descname">iadd_one_mult</code><span class="sig-paren">(</span><em>other0</em>, <em>other1</em>, <em>factor=1.0</em>, <em>transpose0=False</em>, <em>transpose1=False</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd_one_mult" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place addition of multiplication: <code class="docutils literal"><span class="pre">other0</span> <span class="pre">*</span> <span class="pre">other1</span></code></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other0, other1</dt>
<dd>One-index objects that go into the product.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The term added is scaled by this factor.</dd>
<dt>transpose0, transpose1</dt>
<dd>Can be used to select transpose of one-index objects.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd_outer">
<code class="descname">iadd_outer</code><span class="sig-paren">(</span><em>other0</em>, <em>other1</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd_outer" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place addition of outer product of two other DenseTwoIndex</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other0, other1</dt>
<dd>Two-index objects that go into the outer product. They are
raveled before taking the outer product.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The term added is scaled by this factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd_shift">
<code class="descname">iadd_shift</code><span class="sig-paren">(</span><em>lshift</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Add positive shift to elements. If negative subtract shift</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>lshift</dt>
<dd>A scalar used to augment the matrix elements.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd_slice">
<code class="descname">iadd_slice</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Add slice of another DenseTwoIndex object in-place, multiplied by
factor. The slice of other is added to the full range of the array.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseTwoIndex instance to be added</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>A scalar factor</dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>When given, specify the ranges of contribution to be
added. When not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd_t">
<code class="descname">iadd_t</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd_t" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#horton.matrix.dense.DenseTwoIndex.iadd" title="horton.matrix.dense.DenseTwoIndex.iadd"><code class="xref py py-meth docutils literal"><span class="pre">DenseTwoIndex.iadd()</span></code></a>, transpose=True</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iadd_tdot">
<code class="descname">iadd_tdot</code><span class="sig-paren">(</span><em>other0</em>, <em>other1</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iadd_tdot" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place addition of dot product: <code class="docutils literal"><span class="pre">other0.T</span> <span class="pre">*</span> <span class="pre">other1</span></code></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other0, other1</dt>
<dd>Two-index objects that go into the kronecker product.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The term added is scaled by this factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.idot">
<code class="descname">idot</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.idot" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place dot product: self = self * other</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>The other array</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.imul">
<code class="descname">imul</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.imul" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place element-wise multiplication: <code class="docutils literal"><span class="pre">self</span> <span class="pre">*=</span> <span class="pre">other</span> <span class="pre">*</span> <span class="pre">factor</span></code></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseTwoIndex instance.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The two-index object is scaled by this factor.</dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to select a subblock of the (other) object. When
not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.imul_t">
<code class="descname">imul_t</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.imul_t" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place element-wise multiplication: <code class="docutils literal"><span class="pre">self</span> <span class="pre">*=</span> <span class="pre">other.T</span> <span class="pre">*</span> <span class="pre">factor</span></code></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseTwoIndex instance.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The two-index object is scaled by this factor.</dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to select a subblock of the (other) object. When
not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.inner">
<code class="descname">inner</code><span class="sig-paren">(</span><em>vec0</em>, <em>vec1</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.inner" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an inner product of two vectors using the two-index as a metric</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>vec0, vec1</dt>
<dd>The vectors, either DenseOneIndex or numpy arrays.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.inverse">
<code class="descname">inverse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inverse of two-index object</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iortho">
<code class="descname">iortho</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iortho" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place orthogonalization</p>
<p><strong>Arguments:</strong></p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.is_shape_symmetric">
<code class="descname">is_shape_symmetric</code><span class="sig-paren">(</span><em>symmetry</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.is_shape_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the symmetry argument matches the shape</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.is_symmetric">
<code class="descname">is_symmetric</code><span class="sig-paren">(</span><em>symmetry=2</em>, <em>rtol=1e-05</em>, <em>atol=1e-08</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.is_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the symmetry of the array.</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>symmetry</dt>
<dd>The symmetry to check. See <a class="reference internal" href="#dense-matrix-symmetry"><span class="std std-ref">Handling of index symmetry</span></a>
for more details.</dd>
<dt>rtol and atol</dt>
<dd>relative and absolute tolerance. See to <code class="docutils literal"><span class="pre">np.allclose</span></code>.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.iscale">
<code class="descname">iscale</code><span class="sig-paren">(</span><em>factor</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.iscale" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place multiplication with a scalar</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>A scalar factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.itranspose">
<code class="descname">itranspose</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.itranspose" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place transpose</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.new">
<code class="descname">new</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.new" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new two-index object with the same nbasis (and nbasis1)</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.permute_basis">
<code class="descname">permute_basis</code><span class="sig-paren">(</span><em>permutation</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.permute_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder the coefficients for a given permutation of basis functions.</p>
<p>The same permutation is applied to all indexes.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>permutation</dt>
<dd>An integer numpy array that defines the new order of the basis
functions.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.randomize">
<code class="descname">randomize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill with random normal data</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.set_element">
<code class="descname">set_element</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>value</em>, <em>symmetry=2</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.set_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a matrix element</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>i, j</dt>
<dd>The matrix indexes to be set</dd>
<dt>value</dt>
<dd>The value to be assigned to the matrix element.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>symmetry</dt>
<dd>When 2 (the default), the element (j,i) is set to the same
value. When set to 1 the opposite off-diagonal is not set. See
<a class="reference internal" href="#dense-matrix-symmetry"><span class="std std-ref">Handling of index symmetry</span></a> for more details.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.sqrt">
<code class="descname">sqrt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.sqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the real part of the square root of two-index object</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.sum">
<code class="descname">sum</code><span class="sig-paren">(</span><em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sum of all elements (in the selected range)</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to select a subblock of the object to be contracted.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.symmetrize">
<code class="descname">symmetrize</code><span class="sig-paren">(</span><em>symmetry=2</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.symmetrize" title="Permalink to this definition">¶</a></dt>
<dd><p>Symmetrize in-place</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>symmetry</dt>
<dd>The symmetry to impose. See <a class="reference internal" href="#dense-matrix-symmetry"><span class="std std-ref">Handling of index symmetry</span></a> for
more details.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.to_hdf5">
<code class="descname">to_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump this object in an h5py.Group</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>An h5py.Group object.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseTwoIndex.trace">
<code class="descname">trace</code><span class="sig-paren">(</span><em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the trace of the two-index object.</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to select a subblock of the object to be contracted.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseTwoIndex.nbasis">
<code class="descname">nbasis</code><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.nbasis" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseTwoIndex.nbasis1">
<code class="descname">nbasis1</code><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.nbasis1" title="Permalink to this definition">¶</a></dt>
<dd><p>The other size of the two-index object</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseTwoIndex.ndim">
<code class="descname">ndim</code><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of axes in the N-index object.</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseTwoIndex.shape">
<code class="descname">shape</code><a class="headerlink" href="#horton.matrix.dense.DenseTwoIndex.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the object</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.dense.DenseThreeIndex">
<em class="property">class </em><code class="descclassname">horton.matrix.dense.</code><code class="descname">DenseThreeIndex</code><span class="sig-paren">(</span><em>nbasis</em>, <em>nbasis1=None</em>, <em>nbasis2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mod_horton_matrix_base.html#horton.matrix.base.ThreeIndex" title="horton.matrix.base.ThreeIndex"><code class="xref py py-class docutils literal"><span class="pre">horton.matrix.base.ThreeIndex</span></code></a></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions.</dd>
</dl>
<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.assign">
<code class="descname">assign</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.assign" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign with the contents of another object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>Another DenseThreeIndex object or a scalar.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.change_basis_signs">
<code class="descname">change_basis_signs</code><span class="sig-paren">(</span><em>signs</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.change_basis_signs" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for different sign conventions of the basis functions.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>signs</dt>
<dd>A numpy array with sign changes indicated by +1 and -1.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all elements to zero.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.contract_to_two">
<code class="descname">contract_to_two</code><span class="sig-paren">(</span><em>subscripts</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.contract_to_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract self to TwoIndex.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd><code class="docutils literal"><span class="pre">abc-&gt;ac</span></code>: contract first index.</dd>
</dl>
<p><strong>Optional arguments</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2</dt>
<dd>Can be used to contract only a part of the three-index object.
When not given, the full range is used.</dd>
</dl>
<p><strong>Returns:</strong> the contracted two-index object.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.contract_two_to_three">
<code class="descname">contract_two_to_three</code><span class="sig-paren">(</span><em>subscripts</em>, <em>two</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.contract_two_to_three" title="Permalink to this definition">¶</a></dt>
<dd><p>Contracts with two-index to obtain three-index.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd>One of <code class="docutils literal"><span class="pre">abc,ad-&gt;cdb</span></code>, <code class="docutils literal"><span class="pre">abc,ad-&gt;cbd</span></code>, <code class="docutils literal"><span class="pre">abc,da-&gt;dbc</span></code>,
<code class="docutils literal"><span class="pre">abc,da-&gt;bdc</span></code></dd>
<dt>inp</dt>
<dd>A DenseTwoIndex input object.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2</dt>
<dd>Can be used to contract only a part of the three-index object</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.contract_two_to_two">
<code class="descname">contract_two_to_two</code><span class="sig-paren">(</span><em>subscripts</em>, <em>inp</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.contract_two_to_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Contracts self with two-index to obtain two-index.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd>One of <code class="docutils literal"><span class="pre">abc,ab-&gt;ac</span></code>, <code class="docutils literal"><span class="pre">abc,ab-&gt;ca</span></code>, <code class="docutils literal"><span class="pre">abc,bc-&gt;ba</span></code>,
<code class="docutils literal"><span class="pre">abc,bc-&gt;ab</span></code>, <code class="docutils literal"><span class="pre">abc,cb-&gt;ac</span></code>.</dd>
<dt>inp</dt>
<dd>A DenseTwoIndex input object.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of (a part of) the object</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>begin0, end0, begin1, end1, begin2, end2</dt>
<dd>Can be used to select a subblock of the object. When not given,
the full range is used.</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="horton.matrix.dense.DenseThreeIndex.from_hdf5">
<em class="property">classmethod </em><code class="descname">from_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an instance from data previously stored in an h5py.Group.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>An h5py.Group object.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.get_element">
<code class="descname">get_element</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.get_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a matrix element</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.iadd">
<code class="descname">iadd</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.iadd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add another DenseThreeIndex object in-place, multiplied by factor</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseThreeIndex instance to be added</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The added term is scaled by this factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.iadd_expand_two_one">
<code class="descname">iadd_expand_two_one</code><span class="sig-paren">(</span><em>subscripts</em>, <em>two</em>, <em>one</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.iadd_expand_two_one" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place addition of expanded two-index and one-index to three-index.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd>Contraction type: <code class="docutils literal"><span class="pre">ab,c-&gt;cab</span></code> or <code class="docutils literal"><span class="pre">ab,c-&gt;acb</span></code>.</dd>
<dt>two</dt>
<dd>A DenseTwoIndex object.</dd>
<dt>one</dt>
<dd>A DenseOneIndex object.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The added term is scaled by this factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.iadd_expand_two_two">
<code class="descname">iadd_expand_two_two</code><span class="sig-paren">(</span><em>subscripts</em>, <em>two0</em>, <em>two1</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.iadd_expand_two_two" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place addition of expanded two-index and two-index to three-index.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd>Contraction type: <code class="docutils literal"><span class="pre">ac,bc-&gt;abc</span></code>, <code class="docutils literal"><span class="pre">ab,bc-&gt;abc</span></code>,
<code class="docutils literal"><span class="pre">ab,ac-&gt;acb</span></code>, <code class="docutils literal"><span class="pre">cb,ac-&gt;acb</span></code>, <code class="docutils literal"><span class="pre">ac,ab-&gt;abc</span></code>, <code class="docutils literal"><span class="pre">ab,ac-&gt;abc</span></code></dd>
<dt>two0, two1</dt>
<dd>A DenseTwoIndex object.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The added term is scaled by this factor.</dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to contract only a part of the two1 object. When
not given, the full range is used.</dd>
<dt>begin2, end2, begin3, end3</dt>
<dd>Can be used to contract only a part of the two0 object. When
not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.iadd_slice">
<code class="descname">iadd_slice</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.iadd_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Add slice of another DenseThreeIndex object in-place, multiplied by factor</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseThreeIndex instance to be added</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The added term is scaled by this factor.</dd>
<dt>begin0, end0, begin1, end1, begin2, end2</dt>
<dd>Can be used to add only a part of the three-index object</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.iscale">
<code class="descname">iscale</code><span class="sig-paren">(</span><em>factor</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.iscale" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place multiplication with a scalar</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>A scalar factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.new">
<code class="descname">new</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.new" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new three-index object with the same nbasis</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.permute_basis">
<code class="descname">permute_basis</code><span class="sig-paren">(</span><em>permutation</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.permute_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder the coefficients for a given permutation of basis functions.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>permutation</dt>
<dd>An integer numpy array that defines the new order of the basis
functions.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.randomize">
<code class="descname">randomize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill with random normal data</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.set_element">
<code class="descname">set_element</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.set_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a matrix element</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseThreeIndex.to_hdf5">
<code class="descname">to_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump this object in an h5py.Group</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>An h5py.Group object.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseThreeIndex.nbasis">
<code class="descname">nbasis</code><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.nbasis" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseThreeIndex.nbasis1">
<code class="descname">nbasis1</code><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.nbasis1" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseThreeIndex.nbasis2">
<code class="descname">nbasis2</code><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.nbasis2" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseThreeIndex.ndim">
<code class="descname">ndim</code><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of axes in the N-index object.</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseThreeIndex.shape">
<code class="descname">shape</code><a class="headerlink" href="#horton.matrix.dense.DenseThreeIndex.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the object</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.dense.DenseFourIndex">
<em class="property">class </em><code class="descclassname">horton.matrix.dense.</code><code class="descname">DenseFourIndex</code><span class="sig-paren">(</span><em>nbasis</em>, <em>nbasis1=None</em>, <em>nbasis2=None</em>, <em>nbasis3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mod_horton_matrix_base.html#horton.matrix.base.FourIndex" title="horton.matrix.base.FourIndex"><code class="xref py py-class docutils literal"><span class="pre">horton.matrix.base.FourIndex</span></code></a></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<p>nbasis1, nbasis2, nbasis3</p>
<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.assign">
<code class="descname">assign</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.assign" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign with the contents of another object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>Another DenseFourIndex object or a np ndarrray.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.assign_four_index_transform">
<code class="descname">assign_four_index_transform</code><span class="sig-paren">(</span><em>ao_integrals</em>, <em>exp0</em>, <em>exp1=None</em>, <em>exp2=None</em>, <em>exp3=None</em>, <em>method='tensordot'</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.assign_four_index_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform four index transformation.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>oa_integrals</dt>
<dd>A DenseFourIndex with integrals in atomic orbitals.</dd>
<dt>exp0</dt>
<dd>A DenseExpansion object with molecular orbitals</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>exp1, exp2, exp3</dt>
<dd>Can be provided to transform each index differently.</dd>
<dt>method</dt>
<dd>Either <code class="docutils literal"><span class="pre">einsum</span></code> or <code class="docutils literal"><span class="pre">tensordot</span></code> (default).</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.change_basis_signs">
<code class="descname">change_basis_signs</code><span class="sig-paren">(</span><em>signs</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.change_basis_signs" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for different sign conventions of the basis functions.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>signs</dt>
<dd>A numpy array with sign changes indicated by +1 and -1.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all elements to zero.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.contract_four">
<code class="descname">contract_four</code><span class="sig-paren">(</span><em>subscripts</em>, <em>other</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.contract_four" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the trace with other four-index object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd><code class="docutils literal"><span class="pre">abcd,abcd</span></code>, <code class="docutils literal"><span class="pre">abcd,adcb</span></code>, <code class="docutils literal"><span class="pre">abcd,acbd</span></code>, <code class="docutils literal"><span class="pre">abcd,acdb</span></code></dd>
<dt>other</dt>
<dd>A DenseFourIndex instance</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>A scalar factor</dd>
<dt>begin0, end0, begin1, end1, begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the other object. When not
given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.contract_four_to_four">
<code class="descname">contract_four_to_four</code><span class="sig-paren">(</span><em>subscripts</em>, <em>four</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.contract_four_to_four" title="Permalink to this definition">¶</a></dt>
<dd><p>Contracts with a four-index object to obtain a four-index object.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd>Any of <code class="docutils literal"><span class="pre">abcd,cedf-&gt;abfe</span></code>, <code class="docutils literal"><span class="pre">abcd,cefd-&gt;abfe</span></code>,
<code class="docutils literal"><span class="pre">abcd,cedf-&gt;feab</span></code>, <code class="docutils literal"><span class="pre">abcd,cefd-&gt;feab</span></code>, <code class="docutils literal"><span class="pre">abcd,eadf-&gt;fbce</span></code>,
<code class="docutils literal"><span class="pre">abcd,eadf-&gt;cefb</span></code>, <code class="docutils literal"><span class="pre">abcd,aedf-&gt;cbfe</span></code>, <code class="docutils literal"><span class="pre">abcd,aedf-&gt;fecb</span></code>,
<code class="docutils literal"><span class="pre">abcd,acef-&gt;ebfd</span></code>, <code class="docutils literal"><span class="pre">abcd,bdef-&gt;aecf</span></code>, <code class="docutils literal"><span class="pre">abcd,cedf-&gt;abef</span></code>,
<code class="docutils literal"><span class="pre">abcd,cefd-&gt;abef</span></code>, <code class="docutils literal"><span class="pre">abcd,cedf-&gt;efab</span></code>, <code class="docutils literal"><span class="pre">abcd,cefd-&gt;efab</span></code>,
<code class="docutils literal"><span class="pre">abcd,eadf-&gt;ebcf</span></code>, <code class="docutils literal"><span class="pre">abcd,eadf-&gt;cfeb</span></code>, <code class="docutils literal"><span class="pre">abcd,eadf-&gt;cbef</span></code>,
<code class="docutils literal"><span class="pre">abcd,eadf-&gt;efcb</span></code>, <code class="docutils literal"><span class="pre">abcd,eafd-&gt;cbef</span></code>, <code class="docutils literal"><span class="pre">abcd,eafd-&gt;efcb</span></code></dd>
<dt>four</dt>
<dd>An instance of DenseFourIndex.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the other four-index object
(four). When not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.contract_four_to_two">
<code class="descname">contract_four_to_two</code><span class="sig-paren">(</span><em>subscripts</em>, <em>four</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.contract_four_to_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Contracts with a four-index object to obtain a two-index object.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd>Any of <code class="docutils literal"><span class="pre">abcd,aced-&gt;be</span></code>, <code class="docutils literal"><span class="pre">abcd,acde-&gt;be</span></code>, <code class="docutils literal"><span class="pre">abcd,aced-&gt;eb</span></code>,
<code class="docutils literal"><span class="pre">abcd,acde-&gt;eb</span></code>, <code class="docutils literal"><span class="pre">abcd,ecbd-&gt;ae</span></code>, <code class="docutils literal"><span class="pre">abcd,ecdb-&gt;ae</span></code>,
<code class="docutils literal"><span class="pre">abcd,ecdb-&gt;ea</span></code>, <code class="docutils literal"><span class="pre">abcd,ecbd-&gt;ea</span></code>, <code class="docutils literal"><span class="pre">abcd,acbe-&gt;ed</span></code>,
<code class="docutils literal"><span class="pre">abcd,aceb-&gt;ed</span></code>, <code class="docutils literal"><span class="pre">abcd,aebd-&gt;ce</span></code>, <code class="docutils literal"><span class="pre">abcd,aedb-&gt;ce</span></code></dd>
<dt>four</dt>
<dd>An instance of DenseFourIndex.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the other four-index object
(four). When not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.contract_three_to_three">
<code class="descname">contract_three_to_three</code><span class="sig-paren">(</span><em>subscripts</em>, <em>three</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.contract_three_to_three" title="Permalink to this definition">¶</a></dt>
<dd><p>Contracts with a three-index object to obtain a three-index object.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd>Any of <code class="docutils literal"><span class="pre">abcd,ace-&gt;ebd</span></code>, <code class="docutils literal"><span class="pre">abcd,ebd-&gt;ace</span></code></dd>
<dt>three</dt>
<dd>An instance of DenseThreeIndex.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2</dt>
<dd>Can be used to select a subblock of the three-index object
(three). When not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.contract_to_two">
<code class="descname">contract_to_two</code><span class="sig-paren">(</span><em>subscripts</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.contract_to_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract four-index object to two-index object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd><code class="docutils literal"><span class="pre">abcb-&gt;ac</span></code>, <code class="docutils literal"><span class="pre">abbc-&gt;ac</span></code></dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the object. When not given,
the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.contract_two">
<code class="descname">contract_two</code><span class="sig-paren">(</span><em>subscripts</em>, <em>other</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.contract_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute diagonal trace with two-index objects</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd><code class="docutils literal"><span class="pre">aabb,ab</span></code>.</dd>
<dt>other</dt>
<dd>A DenseTwoIndex instance</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>A scalar factor. See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the four-index object. When
not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.contract_two_to_four">
<code class="descname">contract_two_to_four</code><span class="sig-paren">(</span><em>subscripts</em>, <em>two</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em>, <em>begin4=0</em>, <em>end4=None</em>, <em>begin5=0</em>, <em>end5=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.contract_two_to_four" title="Permalink to this definition">¶</a></dt>
<dd><p>Contracts with a two-index object to obtain a four-index object.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd>Any of <code class="docutils literal"><span class="pre">abcd,cd-&gt;acbd</span></code>, <code class="docutils literal"><span class="pre">abcd,cd-&gt;acdb</span></code>, <code class="docutils literal"><span class="pre">abcd,cb-&gt;acdb</span></code>,
<code class="docutils literal"><span class="pre">abcd,cb-&gt;acbd</span></code>, <code class="docutils literal"><span class="pre">abcd,ab-&gt;acbd</span></code>, <code class="docutils literal"><span class="pre">abcd,ab-&gt;acdb</span></code>,
<code class="docutils literal"><span class="pre">abcd,ad-&gt;acbd</span></code>, <code class="docutils literal"><span class="pre">abcd,ad-&gt;acdb</span></code>, <code class="docutils literal"><span class="pre">abcd,ad-&gt;abcd</span></code>,
<code class="docutils literal"><span class="pre">abcd,ad-&gt;abdc</span></code>, <code class="docutils literal"><span class="pre">abcd,bd-&gt;abcd</span></code>, <code class="docutils literal"><span class="pre">abcd,bd-&gt;abdc</span></code>,
<code class="docutils literal"><span class="pre">abcd,bc-&gt;abdc</span></code>, <code class="docutils literal"><span class="pre">abcd,bc-&gt;abcd</span></code>, <code class="docutils literal"><span class="pre">abcd,ac-&gt;abcd</span></code>,
<code class="docutils literal"><span class="pre">abcd,ac-&gt;abdc</span></code>, <code class="docutils literal"><span class="pre">abcd,bd-&gt;cabd</span></code>, <code class="docutils literal"><span class="pre">abcd,bc-&gt;dabc</span></code>,
<code class="docutils literal"><span class="pre">abcd,ca-&gt;cabd</span></code>, <code class="docutils literal"><span class="pre">abcd,da-&gt;dabc</span></code>, <code class="docutils literal"><span class="pre">abcd,dc-&gt;dabc</span></code>,
<code class="docutils literal"><span class="pre">abcd,ba-&gt;dabc</span></code>, <code class="docutils literal"><span class="pre">aabc,dc-&gt;adbc</span></code>, <code class="docutils literal"><span class="pre">aabc,db-&gt;adbc</span></code>,
<code class="docutils literal"><span class="pre">abcc,ad-&gt;abcd</span></code>, <code class="docutils literal"><span class="pre">abcc,bd-&gt;abcd</span></code>, <code class="docutils literal"><span class="pre">abcd,bc-&gt;acbd</span></code>,
<code class="docutils literal"><span class="pre">abcd,eb-&gt;aecd</span></code>, <code class="docutils literal"><span class="pre">abcd,eb-&gt;cdae</span></code>, <code class="docutils literal"><span class="pre">abcd,ed-&gt;ceab</span></code>,
<code class="docutils literal"><span class="pre">abcd,ed-&gt;abce</span></code>, <code class="docutils literal"><span class="pre">abcd,ae-&gt;cdeb</span></code>, <code class="docutils literal"><span class="pre">abcd,ae-&gt;ebcd</span></code>,
<code class="docutils literal"><span class="pre">abcd,ce-&gt;edab</span></code>, <code class="docutils literal"><span class="pre">abcd,ce-&gt;abed</span></code>, <code class="docutils literal"><span class="pre">abcd,ab-&gt;abcd</span></code>,
<code class="docutils literal"><span class="pre">abcd,cb-&gt;abcd</span></code>, <code class="docutils literal"><span class="pre">abcd,ec-&gt;eadb</span></code>, <code class="docutils literal"><span class="pre">abcd,ec-&gt;dbea</span></code>,
<code class="docutils literal"><span class="pre">abcd,ae-&gt;cedb</span></code>, <code class="docutils literal"><span class="pre">abcd,ae-&gt;dbce</span></code>, <code class="docutils literal"><span class="pre">abcd,ec-&gt;ebad</span></code>,
<code class="docutils literal"><span class="pre">abcd,ed-&gt;ebac</span></code>, <code class="docutils literal"><span class="pre">abcd,ec-&gt;adeb</span></code>, <code class="docutils literal"><span class="pre">abcd,ed-&gt;aceb</span></code>,
<code class="docutils literal"><span class="pre">abcd,ae-&gt;debc</span></code>, <code class="docutils literal"><span class="pre">abcd,ae-&gt;cebd</span></code>, <code class="docutils literal"><span class="pre">abcd,ae-&gt;bcde</span></code>,
<code class="docutils literal"><span class="pre">abcd,ae-&gt;bdce</span></code></dd>
<dt>two</dt>
<dd>An instance of DenseTwoIndex.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the four-index object. When
not given, the full range is used.</dd>
<dt>begin4, end4, begin5, end5</dt>
<dd>Can be used to select a subblock of the two-index object (two).
When not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.contract_two_to_three">
<code class="descname">contract_two_to_three</code><span class="sig-paren">(</span><em>subscripts</em>, <em>two</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.contract_two_to_three" title="Permalink to this definition">¶</a></dt>
<dd><p>Contracts with a two-index object to obtain a three-index object.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd>Any of <code class="docutils literal"><span class="pre">aabc,ad-&gt;bcd</span></code>, <code class="docutils literal"><span class="pre">'abcd,ac-&gt;bdc</span></code>, <code class="docutils literal"><span class="pre">abcd,ad-&gt;bcd</span></code>,
<code class="docutils literal"><span class="pre">abcd,bc-&gt;abd</span></code>, <code class="docutils literal"><span class="pre">abcd,ac-&gt;abd</span></code>, <code class="docutils literal"><span class="pre">abcc,dc-&gt;dab</span></code>,
<code class="docutils literal"><span class="pre">abcd,ac-&gt;bcd</span></code>, <code class="docutils literal"><span class="pre">abcc,cd-&gt;dab</span></code>, <code class="docutils literal"><span class="pre">abcc,dc-&gt;abd</span></code>,
<code class="docutils literal"><span class="pre">abcb,db-&gt;adc</span></code>, <code class="docutils literal"><span class="pre">abcc,dc-&gt;adb</span></code>, <code class="docutils literal"><span class="pre">abcb,db-&gt;dac</span></code>,
<code class="docutils literal"><span class="pre">abcc,cd-&gt;abd</span></code></dd>
<dt>two</dt>
<dd>An instance of DenseTwoIndex.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the four-index object. When
not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.contract_two_to_two">
<code class="descname">contract_two_to_two</code><span class="sig-paren">(</span><em>subscripts</em>, <em>two</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em>, <em>begin4=0</em>, <em>end4=None</em>, <em>begin5=0</em>, <em>end5=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.contract_two_to_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract self with a two-index to obtain a two-index.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>subscripts</dt>
<dd>Any of <code class="docutils literal"><span class="pre">abcd,bd-&gt;ac</span></code> (direct), <code class="docutils literal"><span class="pre">abcd,cb-&gt;ad</span></code> (exchange),
<code class="docutils literal"><span class="pre">aabb,cb-&gt;ac</span></code>, <code class="docutils literal"><span class="pre">abcc,bc-&gt;ab</span></code>, <code class="docutils literal"><span class="pre">aabc,ab-&gt;bc</span></code>,
<code class="docutils literal"><span class="pre">aabc,ac-&gt;bc</span></code>, <code class="docutils literal"><span class="pre">abcc,ac-&gt;ab</span></code>, <code class="docutils literal"><span class="pre">abcb,cb-&gt;ac</span></code>,
<code class="docutils literal"><span class="pre">abcb,ab-&gt;ac</span></code>, <code class="docutils literal"><span class="pre">abcc,bc-&gt;ba</span></code>, <code class="docutils literal"><span class="pre">abcc,bc-&gt;ab</span></code>,
<code class="docutils literal"><span class="pre">abcd,ac-&gt;db</span></code>, <code class="docutils literal"><span class="pre">abcd,ad-&gt;cb</span></code>, <code class="docutils literal"><span class="pre">abcd,ac-&gt;bd</span></code>,
<code class="docutils literal"><span class="pre">abcd,ad-&gt;bc</span></code>, <code class="docutils literal"><span class="pre">abcd,ab-&gt;cd</span></code></dd>
<dt>two</dt>
<dd>The input two-index object. (DenseTwoIndex)</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the four-index object. When
not given, the full range is used.</dd>
<dt>begin4, end4, begin5, end5</dt>
<dd>Can be used to select a subblock of the two-index object (two).
When not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of (a part of) the object</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>begin0, end0, begin1, end1, begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the object. When not given,
the full range is used.</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="horton.matrix.dense.DenseFourIndex.from_hdf5">
<em class="property">classmethod </em><code class="descname">from_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an instance from data previously stored in an h5py.Group.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>An h5py.Group object.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.get_element">
<code class="descname">get_element</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>l</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.get_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a matrix element</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.iadd">
<code class="descname">iadd</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.iadd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add another DenseFourIndex object in-place, multiplied by factor</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseFourIndex instance to be added</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The added term is scaled by this factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.iadd_exchange">
<code class="descname">iadd_exchange</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.iadd_exchange" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place addition of its own exchange contribution</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.iadd_expand_three_to_four">
<code class="descname">iadd_expand_three_to_four</code><span class="sig-paren">(</span><em>axis</em>, <em>three</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.iadd_expand_three_to_four" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand three-index object along one axis and add it to four-index
object.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>axis</dt>
<dd>Any of <code class="docutils literal"><span class="pre">1-3-1-2</span></code> (abac += abc), <code class="docutils literal"><span class="pre">1-2-1-2</span></code> (abca += abc),
<code class="docutils literal"><span class="pre">0-2-0-2</span></code> (abcb += abc), <code class="docutils literal"><span class="pre">0-3-0-2</span></code> (abbc += abc),
<code class="docutils literal"><span class="pre">0-2-0-1</span></code> (abcb += acb). The expansion is performed for
repeated indices in the four-index object</dd>
<dt>three</dt>
<dd>An instance of DenseThreeIndex.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.iadd_expand_two_to_four">
<code class="descname">iadd_expand_two_to_four</code><span class="sig-paren">(</span><em>axis</em>, <em>two</em>, <em>factor=1.0</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.iadd_expand_two_to_four" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand two-index object along two axes and add it to four-index
object.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>axis</dt>
<dd>Any of <code class="docutils literal"><span class="pre">1-3</span></code> (abac += bc), <code class="docutils literal"><span class="pre">0-2</span></code> (abcb += ac),
<code class="docutils literal"><span class="pre">0-3</span></code> (abbc += ac), <code class="docutils literal"><span class="pre">1-2</span></code> (abca += bc),
<code class="docutils literal"><span class="pre">diag</span></code> (abab += ab). The expansion is performed for the
repeated indices in the four-index object</dd>
<dt>two</dt>
<dd>An instance of DenseTwoIndex.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1</dt>
<dd>Can be used to select a subblock of the two-index object (two).
When not given, the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.imul">
<code class="descname">imul</code><span class="sig-paren">(</span><em>other</em>, <em>factor=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.imul" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place element-wise multiplication: <code class="docutils literal"><span class="pre">self</span> <span class="pre">*=</span> <span class="pre">other</span> <span class="pre">*</span> <span class="pre">factor</span></code></p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>other</dt>
<dd>A DenseFourIndex instance.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>The four-index object is scaled by this factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.is_shape_symmetric">
<code class="descname">is_shape_symmetric</code><span class="sig-paren">(</span><em>symmetry</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.is_shape_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the symmetry argument matches the shape</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.is_symmetric">
<code class="descname">is_symmetric</code><span class="sig-paren">(</span><em>symmetry=8</em>, <em>rtol=1e-05</em>, <em>atol=1e-08</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.is_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the symmetry of the array.</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>symmetry</dt>
<dd>The symmetry to check. See <a class="reference internal" href="#dense-matrix-symmetry"><span class="std std-ref">Handling of index symmetry</span></a>
for more details. In addition to 1, 2, 4, 8, also &#8216;cdab&#8217; is
supported.</dd>
<dt>rtol and atol</dt>
<dd>relative and absolute tolerance. See to <code class="docutils literal"><span class="pre">np.allclose</span></code>.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.iscale">
<code class="descname">iscale</code><span class="sig-paren">(</span><em>factor</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.iscale" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place multiplication with a scalar</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>A scalar factor.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.itranspose">
<code class="descname">itranspose</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.itranspose" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place transpose: <code class="docutils literal"><span class="pre">0,1,2,3</span> <span class="pre">-&gt;</span> <span class="pre">1,0,3,2</span></code></p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.new">
<code class="descname">new</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.new" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new four-index object with the same nbasis</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.permute_basis">
<code class="descname">permute_basis</code><span class="sig-paren">(</span><em>permutation</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.permute_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder the coefficients for a given permutation of basis functions.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>permutation</dt>
<dd>An integer numpy array that defines the new order of the basis
functions.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.randomize">
<code class="descname">randomize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill with random normal data</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.reshape">
<code class="descname">reshape</code><span class="sig-paren">(</span><em>shape</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshape array</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>shape</dt>
<dd>List containing the new dimension of each axis.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.set_element">
<code class="descname">set_element</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>l</em>, <em>value</em>, <em>symmetry=8</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.set_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a matrix element</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>i, j, k, l</dt>
<dd>The matrix indexes to be set</dd>
<dt>value</dt>
<dd>The value to be assigned to the matrix element.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>symmetry</dt>
<dd>The level of symmetry to be enforced when setting the matrix
element. See <a class="reference internal" href="#dense-matrix-symmetry"><span class="std std-ref">Handling of index symmetry</span></a> for more details.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.slice_to_four">
<code class="descname">slice_to_four</code><span class="sig-paren">(</span><em>subscripts</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.slice_to_four" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a four-index contraction of the four-index object.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>superscripts</dt>
<dd>Any of <code class="docutils literal"><span class="pre">abcd-&gt;abcd</span></code></dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the object. When not given,
the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.slice_to_three">
<code class="descname">slice_to_three</code><span class="sig-paren">(</span><em>subscripts</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.slice_to_three" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a three-index contraction of the four-index object.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>superscripts</dt>
<dd>Any of <code class="docutils literal"><span class="pre">abcc-&gt;bac</span></code>, <code class="docutils literal"><span class="pre">abcc-&gt;abc</span></code>, <code class="docutils literal"><span class="pre">abcb-&gt;abc</span></code>, <code class="docutils literal"><span class="pre">abbc-&gt;abc</span></code></dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.slice_to_two">
<code class="descname">slice_to_two</code><span class="sig-paren">(</span><em>subscripts</em>, <em>out=None</em>, <em>factor=1.0</em>, <em>clear=True</em>, <em>begin0=0</em>, <em>end0=None</em>, <em>begin1=0</em>, <em>end1=None</em>, <em>begin2=0</em>, <em>end2=None</em>, <em>begin3=0</em>, <em>end3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.slice_to_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a two-index contraction of the four-index object.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>superscripts</dt>
<dd>Any of <code class="docutils literal"><span class="pre">aabb-&gt;ab</span></code>, <code class="docutils literal"><span class="pre">abab-&gt;ab</span></code>, <code class="docutils literal"><span class="pre">abba-&gt;ab</span></code></dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>out, factor, clear</dt>
<dd>See <a class="reference internal" href="#horton.matrix.dense.DenseLinalgFactory.einsum" title="horton.matrix.dense.DenseLinalgFactory.einsum"><code class="xref py py-meth docutils literal"><span class="pre">DenseLinalgFactory.einsum()</span></code></a></dd>
<dt>begin0, end0, begin1, end1, begin2, end2, begin3, end3</dt>
<dd>Can be used to select a subblock of the object. When not given,
the full range is used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.sum">
<code class="descname">sum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sum of all elements</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.symmetrize">
<code class="descname">symmetrize</code><span class="sig-paren">(</span><em>symmetry=8</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.symmetrize" title="Permalink to this definition">¶</a></dt>
<dd><p>Symmetrize in-place</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>symmetry</dt>
<dd>The symmetry to impose. See <a class="reference internal" href="#dense-matrix-symmetry"><span class="std std-ref">Handling of index symmetry</span></a> for
more details.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.dense.DenseFourIndex.to_hdf5">
<code class="descname">to_hdf5</code><span class="sig-paren">(</span><em>grp</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump this object in an h5py.Group</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>grp</dt>
<dd>An h5py.Group object.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseFourIndex.nbasis">
<code class="descname">nbasis</code><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.nbasis" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseFourIndex.nbasis1">
<code class="descname">nbasis1</code><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.nbasis1" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseFourIndex.nbasis2">
<code class="descname">nbasis2</code><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.nbasis2" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseFourIndex.nbasis3">
<code class="descname">nbasis3</code><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.nbasis3" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseFourIndex.ndim">
<code class="descname">ndim</code><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of axes in the N-index object.</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.dense.DenseFourIndex.shape">
<code class="descname">shape</code><a class="headerlink" href="#horton.matrix.dense.DenseFourIndex.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the object</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mod_horton_matrix_slicing_h.html" class="btn btn-neutral float-right" title="3.8.5. horton/matrix/slicing.h – Low-level routines for CholeskyLinalgFactory" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mod_horton_matrix_cholesky.html" class="btn btn-neutral" title="3.8.3. horton.matrix.cholesky – Cholesky decomposition of four-index objects" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div>Documentation for HORTON 2.0.0 built from release 2.0.0-244-gaaf5e2b. </div>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2011-2015, The HORTON Development Team.
      Last updated on Jun 16, 2016.
    </p>
  </div>

  <div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.0.0-244-gaaf5e2b',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>